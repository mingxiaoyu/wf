<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="robots" content="noindex, nofollow">
<title>登录设置页面</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}

:root{
    --bg:#f5f6f7;
    --card:#ffffff;
    --muted:#6b6b6b;
    --accent:#ff9500;
    --shadow: 0 10px 30px rgba(20,20,20,0.08);
}

html,body{height:100%}
body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    background: linear-gradient(180deg,#f7f8fa,var(--bg));
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px 18px;
}

/* backdrop + subtle animation retained */
@keyframes blurOverlayAppear{from{opacity:0;backdrop-filter:blur(0)}to{opacity:1;backdrop-filter:blur(10px)}}
@keyframes containerAppear{from{opacity:0;transform:translateY(18px) scale(.98)}to{opacity:1;transform:none}}

#background-iframe{position:fixed;inset:0;width:100%;height:100%;border:0;z-index:-3!important}
#blur-overlay{position:fixed;inset:0;background:linear-gradient(135deg,rgba(102,126,234,0.06),rgba(118,75,162,0.06));backdrop-filter:blur(10px);z-index:-2!important;pointer-events:none;animation:blurOverlayAppear 1.2s ease-out forwards .2s;opacity:1}

.page-wrapper{width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:12px}

.card-container{width:100%;max-width:520px;background:linear-gradient(180deg,rgba(255,255,255,0.92),var(--card));border-radius:16px;padding:36px 36px;box-shadow:var(--shadow);border:1px solid rgba(0,0,0,0.04);backdrop-filter:blur(6px);animation:containerAppear .9s ease-out .15s both;position:relative}
.card-container::before{content:"";position:absolute;left:0;right:0;top:0;height:3px;background:linear-gradient(90deg,var(--accent),#ff7a00);opacity:.9}

.page-header{text-align:center;margin-bottom:18px}
.page-icon{width:64px;height:64px;margin:0 auto 10px;border-radius:14px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent),#ff7a00);box-shadow:0 8px 24px rgba(102,126,234,0.12)}
.page-icon svg{width:32px;height:32px;fill:#fff}
.page-title{font-size:20px;font-weight:600;margin:0;color:#111}

.page-form{display:flex;flex-direction:column;margin-top:18px}
.form-group{margin-bottom:18px;text-align:left;position:relative}
.input-wrapper{position:relative}
.input-icon{position:absolute;left:14px;top:50%;transform:translateY(-50%);width:18px;height:18px;opacity:.45;pointer-events:none}
.form-group input{width:100%;padding:14px;border:1px solid #e6e7ea;border-radius:12px;font-size:15px;color:#111;background:#fff;transition:box-shadow .18s ease,border-color .18s ease;font-family:inherit}
.form-group input.with-icon{padding-left:48px}
.form-group input:focus{outline:0;border-color:var(--accent);box-shadow:0 6px 18px rgba(255,145,0,0.12)}

.btn{padding:14px 18px;border-radius:12px;border:0;font-weight:600;font-size:15px;cursor:pointer;transition:transform .12s ease,box-shadow .12s ease}
.btn-primary{background:linear-gradient(135deg,var(--accent),#ff7a00);color:#fff;box-shadow:0 6px 20px rgba(102,126,234,0.12)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 28px rgba(102,126,234,0.14)}
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn-full-width{width:100%}

.footer-hint{text-align:center;margin-top:18px;color:#9aa0a6;font-size:13px}
.footer-hint a{color:var(--accent);text-decoration:none}

.login-error{margin-top:14px;padding:12px 14px;border-radius:10px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;font-size:14px;font-weight:600;display:flex;align-items:center;gap:10px}
.login-error::before{content:'⚠️'}
.login-error-hidden{display:none}

/* loading spinner preserved */
.btn-loading{position:relative;color:transparent!important}
.btn-loading::after{content:'';position:absolute;width:14px;height:14px;top:50%;left:50%;transform:translate(-50%,-50%);border:2px solid rgba(255,255,255,0.35);border-radius:50%;border-top-color:white;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Responsive tweaks */
@media (max-width:768px){.card-container{padding:28px;border-radius:14px}.page-icon{width:56px;height:56px}.page-title{font-size:18px}}
@media (max-width:420px){.card-container{padding:22px;border-radius:12px}.page-icon{width:52px;height:52px}.page-title{font-size:17px}}
</style>
</head>
<body>
    <!-- 背景内容 -->
    <iframe id="background-iframe" src="/" title="背景内容"></iframe>

    <!-- 毛玻璃效果遮盖层 -->
    <div id="blur-overlay"></div>

    <!-- 登录框容器 -->
    <div class="page-wrapper">
        <div class="card-container">
            <div class="page-header">
                <div class="page-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
                    </svg>
                </div>
                <h1 class="page-title">登录设置页面</h1>
            </div>
            <form id="loginForm" class="page-form">
                <div class="form-group">
                    <div class="input-wrapper">
                        <input type="password" id="password" name="password" class="with-icon" placeholder="请输入您的管理员密码" required autofocus>
                        <svg class="input-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                        </svg>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-full-width" id="loginBtn">立即登录</button>
                <div id="errorMsg" class="login-error login-error-hidden"></div>
            </form>
            <div class="footer-hint">
                由 YingPing Co., Ltd.强力驱动
            </div>
        </div>
    </div>

    <script>
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const password = document.getElementById('password').value;
        const loginBtn = document.getElementById('loginBtn');
        const errorMsg = document.getElementById('errorMsg');
        const passwordInput = document.getElementById('password');
        
        // 清除之前的错误信息
        errorMsg.classList.add('login-error-hidden');
        
        // 按钮加载状态
        loginBtn.disabled = true;
        loginBtn.classList.add('btn-loading');
        
        try {
            const response = await fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'password=' + encodeURIComponent(password)
            });
            
            if (response.ok) {
                const contentType = response.headers.get('content-type');
                
                if (contentType && contentType.includes('application/json')) {
                    // 返回的是JSON，说明登录成功
                    const data = await response.json();
                    if (data.success) {
                        // 登录成功，跳转到管理页面
                        window.location.href = '/admin';
                    }
                } else {
                    // 返回的是HTML，说明密码错误
                    errorMsg.textContent = '密码错误，请重试';
                    errorMsg.classList.remove('login-error-hidden');
                    passwordInput.focus();
                    passwordInput.select();
                }
            } else {
                errorMsg.textContent = '登录失败，请重试';
                errorMsg.classList.remove('login-error-hidden');
            }
        } catch (error) {
            console.error('登录错误:', error);
            errorMsg.textContent = '网络错误，请检查连接';
            errorMsg.classList.remove('login-error-hidden');
        } finally {
            // 恢复按钮状态
            loginBtn.disabled = false;
            loginBtn.classList.remove('btn-loading');
        }
    });
    </script>
</body>
</html>
